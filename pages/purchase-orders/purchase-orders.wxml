<!--pages/purchase-orders/purchase-orders.wxml-->
<view class="container">
  <view class="main-content">
    <!-- 搜索和筛选 -->
  <view class="search-section">
    <view class="search-bar">
      <input 
        class="search-input" 
        placeholder="搜索进货单号、厂商名称..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
      <linear-icon type="search" size="medium" weight="medium" color="primary"></linear-icon>
    </view>
    
    <view class="filter-tabs">
      <view 
        class="filter-tab {{activeFilter === 'all' ? 'active' : ''}}"
        data-filter="all"
        bindtap="onFilterChange"
      >
        全部
      </view>
      <view 
        class="filter-tab {{activeFilter === 'pending' ? 'active' : ''}}"
        data-filter="pending"
        bindtap="onFilterChange"
      >
        待处理
      </view>
      <view 
        class="filter-tab {{activeFilter === 'completed' ? 'active' : ''}}"
        data-filter="completed"
        bindtap="onFilterChange"
      >
        已完成
      </view>
      <view 
        class="filter-tab {{activeFilter === 'cancelled' ? 'active' : ''}}"
        data-filter="cancelled"
        bindtap="onFilterChange"
      >
        已取消
      </view>
    </view>
  </view>

  <!-- 顶部统计卡片 -->
  <view class="stats-section">
    <view class="stats-card">
      <view class="stats-item">
        <view class="stats-number">{{totalOrders}}</view>
        <view class="stats-label">总进货单</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">{{pendingOrders}}</view>
        <view class="stats-label">待处理</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">{{completedOrders}}</view>
        <view class="stats-label">已完成</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">¥{{totalAmount}}</view>
        <view class="stats-label">总金额</view>
      </view>
    </view>
  </view>

  <!-- 进货单列表 -->
  <view class="orders-section">
    <view 
      wx:for="{{filteredOrders}}" 
      wx:key="id" 
      class="order-card {{item.swiped ? 'swiped' : ''}}"
      data-order="{{item}}"
      data-index="{{index}}"
      bindtap="onOrderTap"
      bindtouchstart="onTouchStart"
      bindtouchmove="onTouchMove"
      bindtouchend="onTouchEnd"
    >
      <view class="order-content">
        <view class="order-header">
          <view class="order-info">
            <view class="order-number">{{item.orderNumber}}</view>
            <view class="order-supplier">{{item.supplierName}}</view>
          </view>
          <view class="order-status status-{{item.status}}">
            {{item.statusText}}
          </view>
        </view>
        
        <view class="order-details">
          <view class="detail-row">
            <text class="detail-label"><linear-icon type="package" size="small" weight="medium" color="primary"></linear-icon> 商品数量：</text>
            <text class="detail-value">{{item.itemCount}}种</text>
          </view>
          <view class="detail-row">
            <text class="detail-label"><linear-icon type="money" size="small" weight="medium" color="primary"></linear-icon> 订单金额：</text>
            <text class="detail-value amount">¥{{item.totalAmount}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label"><linear-icon type="calendar" size="small" weight="medium" color="primary"></linear-icon> 下单时间：</text>
            <text class="detail-value">{{item.orderDate}}</text>
          </view>
          <view class="detail-row" wx:if="{{item.deliveryDate}}">
            <text class="detail-label"><linear-icon type="calendar" size="small" weight="medium" color="success"></linear-icon> 交货时间：</text>
            <text class="detail-value">{{item.deliveryDate}}</text>
          </view>
        </view>
      </view>
      
      <!-- 滑动操作按钮 -->
      <view class="swipe-actions">
        <view 
          class="action-btn edit-btn"
          data-order="{{item}}"
          bindtap="onEditOrder"
        >
          编辑
        </view>
        <view 
          class="action-btn delete-btn"
          data-order="{{item}}"
          bindtap="onDeleteOrder"
        >
          删除
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view wx:if="{{filteredOrders.length === 0}}" class="empty-state">
      <view class="empty-icon">
        <linear-icon type="purchase-orders" size="xlarge" weight="medium" color="muted"></linear-icon>
      </view>
      <text class="empty-text">暂无进货单记录</text>
      <text class="empty-hint">点击右下角按钮添加新的进货单</text>
    </view>
  </view>

  <!-- 添加按钮 -->
  <view class="add-btn" bindtap="onAddOrder">
    <text class="add-icon">+</text>
  </view>
  </view>
</view>
