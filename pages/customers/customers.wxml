<!--pages/customers/customers.wxml-->
<view class="container">
  <view class="main-content">
    <!-- æœç´¢å’Œç­›é€‰ -->
    <view class="search-section">
      <view class="search-bar">
        <input 
          class="search-input" 
          placeholder="æœç´¢å®¢æˆ·å§“åã€ç”µè¯..." 
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
        />
        <linear-icon type="search" size="medium" weight="medium" color="primary"></linear-icon>
      </view>
      
      <view class="filter-tabs">
        <view 
          class="filter-tab {{activeFilter === 'all' ? 'active' : ''}}"
          data-filter="all"
          bindtap="onFilterChange"
        >
          å…¨éƒ¨
        </view>
        <view 
          class="filter-tab {{activeFilter === 'vip' ? 'active' : ''}}"
          data-filter="vip"
          bindtap="onFilterChange"
        >
          VIP
        </view>
        <view 
          class="filter-tab {{activeFilter === 'regular' ? 'active' : ''}}"
          data-filter="regular"
          bindtap="onFilterChange"
        >
          æ™®é€š
        </view>
        <view 
          class="filter-tab {{activeFilter === 'inactive' ? 'active' : ''}}"
          data-filter="inactive"
          bindtap="onFilterChange"
        >
          ä¸æ´»è·ƒ
        </view>
      </view>
    </view>

    <!-- é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-section">
    <view class="stats-card">
      <view class="stats-item">
        <view class="stats-number">{{totalCustomers}}</view>
        <view class="stats-label">æ€»å®¢æˆ·</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">{{vipCustomers}}</view>
        <view class="stats-label">VIPå®¢æˆ·</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">{{activeCustomers}}</view>
        <view class="stats-label">æ´»è·ƒå®¢æˆ·</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">Â¥{{totalSales}}</view>
        <view class="stats-label">æ€»é”€å”®é¢</view>
      </view>
    </view>
  </view>

  <!-- å®¢æˆ·åˆ—è¡¨ -->
  <view class="customers-section">
    <view 
      wx:for="{{filteredCustomers}}" 
      wx:key="id" 
      class="customer-card {{item.swiped ? 'swiped' : ''}}"
      data-customer="{{item}}"
      data-index="{{index}}"
      bindtap="onCustomerTap"
      bindtouchstart="onTouchStart"
      bindtouchmove="onTouchMove"
      bindtouchend="onTouchEnd"
    >
      <view class="customer-content">
        <view class="customer-header">
          <view class="customer-avatar">{{item.avatar}}</view>
          <view class="customer-info">
            <view class="customer-name">{{item.name}}</view>
            <view class="customer-phone">{{item.phone}}</view>
          </view>
          <view class="customer-level level-{{item.level}}">
            {{item.levelText}}
          </view>
        </view>
        
        <view class="customer-details">
          <view class="detail-row">
            <text class="detail-label"><linear-icon type="money" size="small" weight="medium" color="primary"></linear-icon> æ¶ˆè´¹æ€»é¢ï¼š</text>
            <text class="detail-value amount">Â¥{{item.totalSpent}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label"><linear-icon type="package" size="small" weight="medium" color="primary"></linear-icon> è´­ä¹°æ¬¡æ•°ï¼š</text>
            <text class="detail-value">{{item.orderCount}}æ¬¡</text>
          </view>
          <view class="detail-row">
            <text class="detail-label"><linear-icon type="calendar" size="small" weight="medium" color="primary"></linear-icon> æœ€è¿‘è´­ä¹°ï¼š</text>
            <text class="detail-value">{{item.lastOrderDate}}</text>
          </view>
          <view class="detail-row" wx:if="{{item.address}}">
            <text class="detail-label">ğŸ“ åœ°å€ï¼š</text>
            <text class="detail-value">{{item.address}}</text>
          </view>
        </view>
      </view>
      
      <!-- æ»‘åŠ¨æ“ä½œæŒ‰é’® -->
      <view class="swipe-actions">
        <view 
          class="action-btn edit-btn"
          data-customer="{{item}}"
          bindtap="onEditCustomer"
        >
          ç¼–è¾‘
        </view>
        <view 
          class="action-btn delete-btn"
          data-customer="{{item}}"
          bindtap="onDeleteCustomer"
        >
          åˆ é™¤
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{filteredCustomers.length === 0}}" class="empty-state">
      <view class="empty-icon">
        <linear-icon type="customers" size="xlarge" weight="medium" color="muted"></linear-icon>
      </view>
      <text class="empty-text">æš‚æ— å®¢æˆ·è®°å½•</text>
      <text class="empty-hint">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®æ·»åŠ æ–°å®¢æˆ·</text>
    </view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-btn" bindtap="onAddCustomer">
    <text class="add-icon">+</text>
  </view>
  </view>
</view>
