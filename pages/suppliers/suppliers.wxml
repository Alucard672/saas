<!--pages/suppliers/suppliers.wxml-->
<view class="container">
  <view class="main-content">
    <!-- æœç´¢å’Œç­›é€‰åŒºåŸŸ -->
    <view class="search-filter-section">
      <view class="search-container">
        <view class="search-box">
          <linear-icon type="search" size="medium" weight="medium" color="primary"></linear-icon>
          <input class="search-input" placeholder="æœç´¢å‚å•†åç§°ã€è”ç³»äººæˆ–ç”µè¯" value="{{searchKeyword}}" bindinput="onSearchInput" />
        </view>
      </view>
      
      <view class="filter-tabs">
        <view class="filter-tab {{activeFilter === 'all' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="all">
          <text class="tab-text">å…¨éƒ¨</text>
        </view>
        <view class="filter-tab {{activeFilter === 'core' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="core">
          <text class="tab-text">æ ¸å¿ƒå‚å•†</text>
        </view>
        <view class="filter-tab {{activeFilter === 'regular' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="regular">
          <text class="tab-text">æ™®é€šå‚å•†</text>
        </view>
        <view class="filter-tab {{activeFilter === 'inactive' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="inactive">
          <text class="tab-text">åœç”¨</text>
        </view>
      </view>
    </view>

    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <view class="stats-overview">
      <view class="overview-card primary">
        <view class="overview-icon">
          <linear-icon type="suppliers" size="large" weight="medium" color="white"></linear-icon>
        </view>
        <view class="overview-content">
          <text class="overview-number">{{totalSuppliers}}</text>
          <text class="overview-label">å‚å•†æ€»æ•°</text>
        </view>
      </view>
      <view class="overview-mini">
        <view class="mini-card">
          <text class="mini-number">{{coreSuppliers}}</text>
          <text class="mini-label">æ ¸å¿ƒå‚å•†</text>
        </view>
        <view class="mini-card">
          <text class="mini-number">{{activeSuppliers}}</text>
          <text class="mini-label">æ´»è·ƒå‚å•†</text>
        </view>
      </view>
    </view>

    <!-- å‚å•†åˆ—è¡¨åŒºåŸŸ -->
    <view class="suppliers-section">
      <view class="section-header">
        <text class="section-title">å‚å•†åˆ—è¡¨</text>
        <text class="section-count">å…±{{filteredSuppliers.length}}å®¶å‚å•†</text>
      </view>

      <scroll-view class="suppliers-list" scroll-y="true" wx:if="{{filteredSuppliers.length > 0}}">
        <view class="supplier-item-wrapper" wx:for="{{filteredSuppliers}}" wx:key="id">
          <view class="supplier-item {{item.swiped ? 'swiped' : ''}}" bindtap="onSupplierTap" data-supplier="{{item}}" bindtouchstart="onTouchStart" bindtouchmove="onTouchMove" bindtouchend="onTouchEnd" data-index="{{index}}">
            <view class="status-indicator {{item.level === 'core' ? 'core' : item.level === 'regular' ? 'normal' : 'inactive'}}"></view>
            
            <view class="supplier-content">
              <view class="supplier-header">
                <view class="supplier-avatar">
                  <text class="supplier-icon">{{item.avatar || 'ğŸ­'}}</text>
                </view>
                <view class="supplier-basic">
                  <text class="supplier-name">{{item.name}}</text>
                  <text class="supplier-contact">{{item.contactPerson}} - {{item.phone}}</text>
                  <text class="supplier-level">{{item.levelText}}</text>
                </view>
                <view class="supplier-status">
                  <text class="status-text {{item.level}}">{{item.statusText}}</text>
                </view>
              </view>

              <view class="supplier-info">
                <view class="info-row">
                  <view class="info-item">
                    <text class="info-label">åˆä½œé‡‘é¢</text>
                    <text class="info-value price">Â¥{{item.totalAmount}}</text>
                  </view>
                  <view class="info-item">
                    <text class="info-label">è¿›è´§æ¬¡æ•°</text>
                    <text class="info-value">{{item.orderCount}}æ¬¡</text>
                  </view>
                </view>
                <view class="info-row">
                  <view class="info-item">
                    <text class="info-label">æœ€åè¿›è´§</text>
                    <text class="info-value">{{item.lastOrderDate}}</text>
                  </view>
                  <view class="info-item">
                    <text class="info-label">åœ°å€</text>
                    <text class="info-value">{{item.address}}</text>
                  </view>
                </view>
              </view>
            </view>
          </view>

          <!-- å·¦æ»‘æ“ä½œæŒ‰é’® -->
          <view class="swipe-actions {{item.swiped ? 'show' : ''}}">
            <view class="action-btn edit" bindtap="onEditSupplier" data-supplier="{{item}}">
              <linear-icon type="edit" size="small" weight="medium" color="primary"></linear-icon>
              <text class="action-text">ç¼–è¾‘</text>
            </view>
            <view class="action-btn delete" bindtap="onDeleteSupplier" data-supplier="{{item}}">
              <linear-icon type="delete" size="small" weight="medium" color="danger"></linear-icon>
              <text class="action-text">åˆ é™¤</text>
            </view>
          </view>
        </view>
      </scroll-view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:else>
        <text class="empty-icon">ğŸ­</text>
        <text class="empty-title">æš‚æ— å‚å•†</text>
        <text class="empty-subtitle">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®æ·»åŠ ç¬¬ä¸€å®¶å‚å•†</text>
        <view class="empty-action" bindtap="onAddSupplier">
          <text class="action-text">æ·»åŠ å‚å•†</text>
        </view>
      </view>
    </view>

    <view class="bottom-safe-area"></view>
  </view>

  <!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="onAddSupplier">
    <text class="fab-icon">+</text>
  </view>
</view>